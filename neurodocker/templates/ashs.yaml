# Instructions to install Automatic Segmentation of Hippocampal Subfields (ASHS).
#
# Repository: https://github.com/pyushkevich/ashs.git
# Website: https://www.nitrc.org/projects/ashs/

generic:
  binaries:
    urls:
      "1.0.0": https://www.dropbox.com/s/ijkxmopv088e4iu/ashs-fastashs-20170915.zip?dl=0
      # Ubuntu 16.04: 
      "2.0.0": https://www.nitrc.org/frs/download.php/10887/ashs-fastashs_2.0.0_07202018.zip
      # Ubuntu 16.04: works, but some atlases are not working yet
    dependencies:
        apt: libxt6
        yum: libXt
    env:
      PATH: "{{ ashs.install_path }}/bin:$PATH"
      ASHS_ROOT: "{{ ashs.install_path }}"
    instructions: |
      {{ ashs.install_dependencies() }}
      echo "Downloading ashs ..."
      curl {{ ashs.curl_opts }} -o /tmp/ashs.zip "{{ ashs.binaries_url }}"
      unzip /tmp/ashs.zip -d /
      {% if ashs.version == "1.0.0" -%}
      ln -s /ashs-1.0.0/ {{ ashs.install_path }}
      echo "Downloading atlas compatible with version 1.0.0 ..."
      mkdir /ashs_atlas_upennpmc_20170810
      curl {{ ashs.curl_opts }} http://ashs.projects.nitrc.org/atlas_upennpmc/ashs_atlas_upennpmc_20170810.tar \
      | tar -x -C /ashs_atlas_upennpmc_20170810
      {% endif -%}
      {% if ashs.version == "2.0.0x" -%}
      ln -s /opt/ashs-fastashs_beta/ {{ ashs.install_path }}
      echo "Downloading atlas compatible with version 2.0.0 ..."
      mkdir /ashs_atlas_magdeburg_7t_20180416
      curl {{ ashs.curl_opts }} http://ashs.projects.nitrc.org/atlas_magdeburg/ashs_atlas_magdeburg_7t_20180416.tgz \
            | tar -xz -C /ashs_atlas_magdeburg_7t_20180416
      {% endif -%}